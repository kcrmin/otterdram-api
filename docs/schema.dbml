// OtterDram DB Schema
// version: 1.1.0
// last updated: 2025-07-08
// author: kcrmin

// ======================= ENUMS (ìƒìˆ˜ íƒ€ìž…) =======================
// 1. ê³µí†µ/ê¸°ì´ˆ
Enum LanguageCode {
  EN
  KO
  JA
}
Enum TernaryStatus {
  TRUE
  FALSE
  UNKNOWN
}

// 2. ë‹¨ìœ„ ë° ì„œë¹™ ê´€ë ¨
Enum VolumeUnit {
  ML      // ë°€ë¦¬ë¦¬í„°
  CL      // ì„¼í‹°ë¦¬í„°
  L       // ë¦¬í„°
  OZ      // ì˜¨ìŠ¤
  SHOT    // ìƒ·(ì£¼ë¡œ 30~50ml)
}
Enum ServingStyle {
  NEAT
  ON_THE_ROCKS
  WITH_WATER
  HIGHBALL
  OTHER
}
Enum AgeStatementType {
  STATED     // ì—°ì‹ ëª…ì‹œ
  NAS        // No Age Statement
  UNAGED     // ë¹„ìˆ™ì„±
}
Enum BottlingStrengthType {
  STANDARD
  CASK_STRENGTH
  BATCH_STRENGTH
  UNKNOWN
}
Enum FillNumber {
  UNKNOWN
  VIRGIN
  REFILL
  MULTI_REFILL
  FIRST_FILL
  SECOND_FILL
  THIRD_FILL
}

// 3. ìœ ì € ê´€ë ¨
Enum Privacy {
  PUBLIC
  FOLLOWERS_ONLY
  MEMBERS_ONLY
  PRIVATE
}
Enum Gender {
  MALE
  FEMALE
  RATHER_NOT_SAY
  UNSPECIFIED
  OTHER
}
Enum UserStatus {
  ACTIVE
  SUSPENDED     // ìž„ì‹œì •ì§€
  BANNED        // ì˜êµ¬ì •ì§€
  DEACTIVATED   // ìžì§„ ë¹„í™œì„±í™”
  DELETED
}
Enum DistilleryOperationalStatus {
  ACTIVE             // ì •ìƒ ìš´ì˜ ì¤‘
  INACTIVE           // ì¼ì‹œ ë¹„ê°€ë™(ì¼ì‹œ ì¤‘ë‹¨, íœ´ì—…)
  CLOSED             // ì™„ì „ íì‡„(ë¬¸ ë‹«ìŒ)
  DEMOLISHED         // ì² ê±°ë¨(ê±´ë¬¼/ì‹œì„¤ ì‚¬ë¼ì§)
  UNDER_CONSTRUCTION // ê±´ì„¤ ì¤‘(ë¯¸ì™„ê³µ)
  PLANNED            // ì„¤ë¦½ ì˜ˆì •(ê³„íšë§Œ ìžˆìŒ)
  MOTHBALLED         // ìž¥ê¸° ë¹„ê°€ë™(ì‹œì„¤ ìœ ì§€/ìž¬ê°œ ê°€ëŠ¥)
  RENOVATION         // ë¦¬ë…¸ë² ì´ì…˜(ê³µì‚¬/ê°œì¡° ì¤‘)
  UNKNOWN            // ì •ë³´ ì—†ìŒ/ë¶ˆë¶„ëª…
}

// 4. ë°ì´í„°/ìŠ¹ì¸/ì´ê´€
Enum FollowStatus {
  APPROVED
  PENDING
  REJECTED
}
Enum DataStatus {
  PENDING
  CONFIRMED
  REJECTED
}
Enum TokenStatus {
  ACTIVE
  INACTIVE
  DELETED
}

// 5. ì‹ ê³ /íˆ¬í‘œ/ì¸ì¦
Enum ReportStatus {
  PENDING
  REVIEWED
  IGNORED
  ACTIONED
}
Enum ReportTargetType {
  BRAND                   // ë¸Œëžœë“œ
  COLLECTION              // ì»¬ë ‰ì…˜(ì‹œë¦¬ì¦ˆ)
  MODEL                   // ëª¨ë¸(ìƒí’ˆêµ°)
  RELEASE                 // ë¦¬ë¦¬ì¦ˆ(ê°œë³„ ì¶œì‹œ ìƒí’ˆ)
  REVIEW                  // ë¦¬ë·°
  SHELF                   // ìœ ì € ì„ ë°˜
  BOTTLE                  // ì†Œìœ  ë³‘
  VIAL                    // ì†Œë¶„ë³‘(ë°”ì´ì•Œ)
  COMPANY                 // ê¸°ì—…(íšŒì‚¬)
  DISTILLERY              // ì¦ë¥˜ì†Œ
  CATEGORY                // ì¹´í…Œê³ ë¦¬
  CASK                    // ìºìŠ¤í¬ ë§ˆìŠ¤í„°

  // ëŒ“ê¸€ ë° íˆ¬í‘œ ì—”í‹°í‹° (ê° ì—”í‹°í‹°ë³„ ëŒ“ê¸€)
  BRAND_COMMENT           // ë¸Œëžœë“œ ëŒ“ê¸€
  COLLECTION_COMMENT      // ì»¬ë ‰ì…˜ ëŒ“ê¸€
  MODEL_COMMENT           // ëª¨ë¸ ëŒ“ê¸€
}
Enum VoteType {
  LIKE
  DISLIKE
}
Enum AuthMethod {
  NFC
  QR
  CODE
}

// 6. ë¦¬ë·°/í‰ê°€ ê´€ë ¨
Enum Tier {
  UNACCEPTABLE      // 50 - 59
  BELOW_AVERAGE     // 60 - 69
  AVERAGE           // 70 - 79
  DECENT            // 80 - 89
  OUTSTANDING       // 90 - 95
  EXTRAORDINARY     // 96 - 100
}
Enum AlcoholPresence {
  NONE
  LOW
  MEDIUM
  HIGH
  VERY_HIGH
}
Enum Complexity {
  LOW
  MEDIUM
  HIGH
}
Enum BodyIntensity {
  LIGHT_BODY
  MEDIUM_BODY
  FULL_BODY
}
Enum FinishLength {
  VERY_SHORT
  SHORT
  MEDIUM
  LONG
  VERY_LONG
  EXTRA_LONG
}
Enum Balance {
  IMBALANCED
  MODERATELY_BALANCED
  WELL_BALANCED
}
Enum PeatLevel {
  UNPEATED
  LIGHTLY_PEATED
  PEATED
  HEAVILY_PEATED
  SUPER_HEAVILY_PEATED
  UNKOWN
}

// ================== ì§€ì—­ ì •ë³´ (Geo) ==================
// ì°¸ê³ : https://github.com/dr5hn/countries-states-cities-database

// ---- ëŒ€ë¥™/ì§€ì—­ ----
Table regions {
  id bigint [pk, not null, increment]
  name varchar(100) [not null]
  translations text [note: "ë‹¤êµ­ì–´ JSON, ì˜ˆ: {'ko':'ìœ ëŸ½'}"]
  created_at timestamp
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  flag smallint [not null, default: 1, note: "0=ë¹„í™œì„±, 1=í™œì„±"]
  "wikiDataId" varchar(255) [note: "ìœ„í‚¤ë°ì´í„° Që²ˆí˜¸, ì˜ˆ: 'Q46'"]
}
// ---- í•˜ìœ„ ì§€ì—­ ----
Table subregions {
  id bigint [pk, not null, increment]
  name varchar(100) [not null]
  translations text [note: "ë‹¤êµ­ì–´ JSON, ì˜ˆ: {'ko':'ì„œìœ ëŸ½'}"]
  region_id bigint [not null, ref: > regions.id]
  created_at timestamp
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  flag smallint [not null, default: 1, note: "0=ë¹„í™œì„±, 1=í™œì„±"]
  "wikiDataId" varchar(255) [note: "ìœ„í‚¤ë°ì´í„° Që²ˆí˜¸, ì˜ˆ: 'Q990'"]
}
// ---- êµ­ê°€ ----
Table countries {
  id bigint [pk, not null, increment]
  name varchar(100) [not null, note: "ì˜ë¬¸ êµ­ê°€ëª…, ì˜ˆ: 'South Korea'"]
  iso3 char(3) [note: "ISO 3166-1 alpha-3, ì˜ˆ: 'KOR'"]
  numeric_code char(3) [note: "ISO 3166-1 numeric, ì˜ˆ: '410'"]
  iso2 char(2) [note: "ISO 3166-1 alpha-2, ì˜ˆ: 'KR'"]
  phonecode varchar(255) [note: "êµ­ì œì „í™”ì½”ë“œ, ì˜ˆ: '82'"]
  capital varchar(255) [note: "ìˆ˜ë„, ì˜ˆ: 'Seoul'"]
  currency varchar(255) [note: "í†µí™”ì½”ë“œ, ì˜ˆ: 'KRW'"]
  currency_name varchar(255) [note: "í†µí™”ëª…, ì˜ˆ: 'South Korean won'"]
  currency_symbol varchar(255) [note: "í†µí™”ê¸°í˜¸, ì˜ˆ: 'â‚©'"]
  tld varchar(255) [note: "ìµœìƒìœ„ ë„ë©”ì¸, ì˜ˆ: '.kr'"]
  native varchar(255) [note: "ìžêµ­ì–´ êµ­ê°€ëª…, ì˜ˆ: 'ëŒ€í•œë¯¼êµ­'"]
  region varchar(255) [note: "ìƒìœ„ ì§€ì—­ëª…(ì˜ë¬¸), ì˜ˆ: 'Asia'"]
  region_id bigint [ref: > regions.id]
  subregion varchar(255) [note: "í•˜ìœ„ ì§€ì—­ëª…(ì˜ë¬¸), ì˜ˆ: 'Eastern Asia'"]
  subregion_id bigint [ref: > subregions.id]
  nationality varchar(255) [note: "êµ­ë¯¼ëª…, ì˜ˆ: 'Korean'"]
  timezones text [note: "JSON ë°°ì—´, ì˜ˆ: ['UTC+9']"]
  translations text [note: "ë‹¤êµ­ì–´ JSON, ì˜ˆ: {'ko':'ëŒ€í•œë¯¼êµ­'}"]
  latitude numeric(10,8)
  longitude numeric(11,8)
  emoji varchar(191) [note: "êµ­ê¸° ì´ëª¨ì§€, ì˜ˆ: 'ðŸ‡°ðŸ‡·'"]
  "emojiU" varchar(191) [note: "ìœ ë‹ˆì½”ë“œ, ì˜ˆ: 'U+1F1F0 U+1F1F7'"]
  created_at timestamp
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  flag smallint [not null, default: 1, note: "0=ë¹„í™œì„±, 1=í™œì„±"]
  "wikiDataId" varchar(255) [note: "ìœ„í‚¤ë°ì´í„° Që²ˆí˜¸, ì˜ˆ: 'Q884'"]
}
// ---- ì£¼/ë„ ----
Table states {
  id bigint [pk, not null, increment]
  name varchar(255) [not null, note: "ì£¼/ë„ ëª…ì¹­, ì˜ˆ: 'California', 'ì„œìš¸íŠ¹ë³„ì‹œ'"]
  country_id bigint [not null, ref: > countries.id]
  country_code char(2) [not null, note: "ISO êµ­ê°€ì½”ë“œ, ì˜ˆ: 'US', 'KR'"]
  fips_code varchar(255) [note: "ë¯¸êµ­ ë“± FIPS ì½”ë“œ, ì˜ˆ: 'CA'"]
  iso2 varchar(255) [note: "ISO 2ìžë¦¬ ì£¼/ë„ ì½”ë“œ, ì˜ˆ: 'CA', '11'"]
  type varchar(191) [note: "í–‰ì •êµ¬ì—­ ì¢…ë¥˜, ì˜ˆ: 'State', 'Province', 'Special City'"]
  level integer [note: "í–‰ì • ë‹¨ê³„, ì˜ˆ: 1=ê´‘ì—­, 2=ì‹œ/êµ° ë“±"]
  parent_id integer
  latitude numeric(10,8)
  longitude numeric(11,8)
  created_at timestamp
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  flag smallint [not null, default: 1, note: "0=ë¹„í™œì„±, 1=í™œì„±"]
  "wikiDataId" varchar(255) [note: "ìœ„í‚¤ë°ì´í„° Që²ˆí˜¸, ì˜ˆ: 'Q485705'"]
}
// ---- ë„ì‹œ ----
Table cities {
  id bigint [pk, not null, increment]
  name varchar(255) [not null, note: "ë„ì‹œëª…(ì˜ë¬¸), ì˜ˆ: 'Seoul', 'San Francisco'"]
  state_id bigint [not null, ref: > states.id]
  state_code varchar(255) [not null, note: "ì£¼/ë„ ì½”ë“œ, ì˜ˆ: 'CA', '11'"]
  country_id bigint [not null, ref: > countries.id]
  country_code char(2) [not null, note: "ISO êµ­ê°€ì½”ë“œ, ì˜ˆ: 'US', 'KR'"]
  latitude numeric(10,8) [not null]
  longitude numeric(11,8) [not null]
  created_at timestamp [not null, default: `'2014-01-01 12:01:01'`]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  flag smallint [not null, default: 1, note: "0=ë¹„í™œì„±, 1=í™œì„±"]
  "wikiDataId" varchar(255) [note: "ìœ„í‚¤ë°ì´í„° Që²ˆí˜¸, ì˜ˆ: 'Q8684'"]
}

// ================== ì‚¬ìš©ìž(ìœ ì €) ==================
// ---- ì‚¬ìš©ìž ----
Table users {
  id id [pk, increment]
  username varchar(50) [not null, unique, note: "@username"]
  email varchar(255) [not null, unique, note: "ì¸ì¦ëœ ì´ë©”ì¼ë§Œ"]
  profile_image varchar(255)
  verified boolean [not null, default: false, note: "ì¸ì¦ëœ ì¸í”Œë£¨ì–¸ì„œ/ì „ë¬¸ê°€"]
  user_privacy Privacy [not null, default: 'PUBLIC']
  user_status UserStatus [not null, default: 'ACTIVE']
  last_login_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  deleted_at timestamp
}
// ---- ì‚¬ìš©ìž ì •ë³´ ----
Table user_profiles {
  id bigint [pk, increment]
  user_id bigint [ref: - users.id, unique, not null]
  display_name varchar(100) [not null]
  bio text
  city_id bigint [ref: > cities.id]
  birthday date [not null]
  gender Gender [not null, default: 'UNSPECIFIED']
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
}
// ---- ì†Œì…œ ë¡œê·¸ì¸ ----
Table user_social_accounts {
  id bigint [pk, increment]
  user_id bigint [not null, ref: > users.id]
  provider varchar(50) [not null]
  provider_id varchar(255) [not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  indexes {
    (provider, provider_id) [unique]
  }
}
// ---- ì‚¬ìš©ìž ì„¤ì • ----
Table user_settings {
  id bigint [pk, increment]
  user_id bigint [ref: - users.id, not null, unique]
  // marketing_opt_in boolean [not null, default: false, note: "ë§ˆì¼€íŒ… ìˆ˜ì‹  ë™ì˜ ì—¬ë¶€"]
  // marketing_opt_at timestamp [not null, note: "ë§ˆì¼€íŒ… ìˆ˜ì‹  ë™ì˜ ì‹œê°(ìµœì´ˆ ë™ì˜/ì² íšŒ ë³€ê²½ ì‹œë§ˆë‹¤ ê°±ì‹ )"]
  terms_version_agreed varchar(50) [not null, note: "ì•½ê´€ë²„ì „. ì˜ˆ: '2024.06'"]
  // notification_opt_in boolean [not null, default: false, note: "ì´ë©”ì¼/ì•± ì•Œë¦¼ ì „ì²´ ë™ì˜ ì—¬ë¶€"]
  // push_opt_in boolean [not null, default: false, note: "ì•± í‘¸ì‹œ ì•Œë¦¼ ë™ì˜ ì—¬ë¶€"]
  lang_preference LanguageCode [not null, default: 'en']
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
}

// ---- ì‚¬ìš©ìž ì—­í•  ----
Table user_roles {
  id bigint [pk, increment]
  user_id bigint [ref: > users.id, not null]
  role_id bigint [ref: > roles.id, not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`, note: "ROLE_USER: created_at, ROLE_ADMIN: assigned_at"]
  created_by bigint [ref: > users.id, not null, note: "ROLE_USER: created_by, ROLE_ADMIN: assigned_by"]
  indexes {
    (user_id, role_id) [unique]
  }
}

Table roles {
  id bigint [pk, increment]
  role_name varchar(50) [unique, not null, note: "ROLE_REVIEWER, ROLE_EDITOR, ROLE_ADMIN, ROLE_USER"]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_by bigint [ref: > users.id, not null]
}

// ---- íŒ”ë¡œìš° ê´€ê³„ ----
Table user_follows {
  id bigint [pk, increment]
  follower_id bigint [ref: > users.id, not null]
  followee_id bigint [ref: > users.id, not null]
  status FollowStatus [not null, default: `APPROVED`]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
}
// ---- ì‚¬ìš©ìž ì°¨ë‹¨ ----
Table user_blocks {
  id bigint [pk, increment]
  blocker_id bigint [ref: > users.id, not null]
  blocked_id bigint [ref: > users.id, not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
}

// ================== ì‹ ê³ /ë¦¬í¬íŠ¸ ==================
// ---- ìœ ì € ì‹ ê³  ----
Table user_reports {
  id bigint [pk, increment]
  reporter_id bigint [ref: > users.id, not null]
  reported_user_id bigint [ref: > users.id, not null]
  language_code LanguageCode [not null]
  report_reason varchar(100) [not null, note: "ì˜ˆ: 'ìš•ì„¤', 'ìŠ¤íŒ¸' ë“±"]
  report_description text
  reported_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  status ReportStatus [not null, default: 'PENDING']
}
// ---- ì»¨í…ì¸  ì‹ ê³  ----
Table content_reports {
  id bigint [pk, increment]
  reporter_id bigint [ref: > users.id, not null]
  target_type ReportTargetType [not null]
  target_id bigint [not null]
  language_code LanguageCode [not null]
  report_reason varchar(100) [not null]
  report_description text
  reported_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  status ReportStatus [not null, default: 'PENDING']
}

// ================== SHELVES / BOTTLES / VIALS / CONSUMPTION / REVIEWS ==================
// ---- ì„ ë°˜(ìœ ì € ì»¬ë ‰ì…˜) ----
Table shelves {
  id bigint [pk, increment]
  owner_id bigint [not null, ref: > users.id]
  privacy Privacy [not null, default: 'PUBLIC']
  shelf_name varchar(100) [not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
}
Table shelf_share_tokens {
  id bigint [pk, increment]
  shelf_id bigint [not null, ref: > shelves.id]
  claim_type AuthMethod [not null]
  claim_token varchar(100) [not null, unique]
  status TokenStatus [default: 'ACTIVE']
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
}

// ---- ì†Œìœ  ë³‘ ì •ë³´ ----
Table bottles {
  id bigint [pk, increment]
  shelf_id bigint [ref: > shelves.id, not null]
  release_id bigint [ref: > releases.id, not null]
  note varchar(255)
  residual_volume smallint
  residual_volume_unit VolumeUnit [default: 'ML', not null]
  bottle_size smallint
  bottle_size_unit VolumeUnit [default: 'ML', not null]
  acquired_at timestamp
  opened boolean [not null, default: false]
  first_opened_at timestamp
  last_opened_at timestamp
  completed boolean [not null, default: false]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_by bigint [ref: > users.id, not null]
}
Table bottle_transfers {
  id bigint [pk, increment]
  bottle_id bigint [ref: > bottles.id, not null]
  status TokenStatus [not null, default: 'ACTIVE']
  auth_at timestamp
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  claimed_by bigint [ref: > users.id, note: "claimëœ ì´í›„ ìž…ë ¥"]
}
Table bottle_transfer_tokens {
  id bigint [pk, increment]
  bottle_transfer_id bigint [not null, ref: > bottle_transfers.id]
  claim_type AuthMethod [not null]
  claim_token varchar(100) [not null, unique]
  expires_at timestamp [not null]

  indexes {
    (bottle_transfer_id, claim_type) [unique]
  }
}

// ---- ì†Œë¶„ë³‘(ë°”ì´ì•Œ) ----
Table vials {
  id bigint [pk, increment]
  shelf_id bigint [ref: > shelves.id, not null]
  release_id bigint [ref: > releases.id, not null]
  vial_name varchar(75) [not null]
  is_blind boolean [not null, default: false]
  note varchar(255)
  vial_size smallint
  vial_size_unit VolumeUnit [default: 'ML', not null]
  acquired_at timestamp
  breathed_for interval [note: "ì²« ê°œë´‰ í›„ ì§€ë‚œ ì‹œê°„ (last_opened_at - first_opened_at)"]
  completed boolean [not null, default: false]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_by bigint [ref: > users.id, not null]
}
Table vial_transfers {
  id bigint [pk, increment]
  vial_id bigint [ref: > vials.id, not null]
  status TokenStatus [not null, default: 'ACTIVE']
  auth_at timestamp
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  claimed_by bigint [ref: > users.id, note: "claimëœ ì´í›„ ìž…ë ¥"]
}
Table vial_transfer_tokens {
  id bigint [pk, increment]
  vial_transfer_id bigint [not null, ref: > vial_transfers.id]
  claim_type AuthMethod [not null]
  claim_token varchar(100) [not null, unique]
  expires_at timestamp [not null]

  indexes {
    (vial_transfer_id, claim_type) [unique]
  }
}

// ---- ë¦¬ë·° ----
Table reviews {
  review_id bigint [pk, increment]
  release_id bigint [ref: > releases.id, not null]
  vial_id bigint [ref: > vials.id]
  privacy Privacy [not null, default: 'PUBLIC']
  language_code LanguageCode [not null]
  blind_tasting boolean [not null, default: false]
  serving_style ServingStyle [not null]
  serving_size smallint [not null]
  serving_size_unit VolumeUnit [default: 'ML', not null]
  breathed_for interval [note: "ì²« ê°œë´‰ í›„ ì§€ë‚œ ì‹œê°„ (last_opened_at - first_opened_at)"]
  tier Tier [not null]
  score decimal(4, 1)
  alcohol_presence AlcoholPresence [not null]
  complexity Complexity [not null]
  body_intensity BodyIntensity [not null]
  finish_length FinishLength [not null]
  balance Balance [not null]
  overall_description text [note: "ì¢…í•© í‰ê°€"]
  nose_description text [note: "í–¥"]
  palate_description text [note: "ë§›"]
  finish_description text [note: "í”¼ë‹ˆì‹œ"]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_by bigint [ref: > users.id, not null]
}

// ================== ì¹´í…Œê³ ë¦¬ (ë§ˆìŠ¤í„°) ==================
Table categories {
  id bigint [pk, increment]
  name varchar(255) [not null, note: "ì¹´í…Œê³ ë¦¬ëª…, ì˜ˆ: 'Single Malt', 'Bourbon', 'Blended'"]
  translations text [note: "ë‹¤êµ­ì–´ JSON"]
  parent_id bigint [ref: > categories.id, default: null]
  path varchar(100) [not null, note: "materialized path, ì˜ˆ: '1/2/3'"]
  depth smallint [not null, note: "ì¹´í…Œê³ ë¦¬ ê¹Šì´, ë£¨íŠ¸=0, ì˜ˆ: 1=1ë‹¨ê³„, 2=2ë‹¨ê³„"]
  descriptions text [note: "ë‹¤êµ­ì–´ JSON"]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_by bigint [ref: > users.id, not null]
}

// ================== ë¸Œëžœë“œ & ìœ„ìŠ¤í‚¤ êµ¬ì¡° ==================
// (ê¸°ì—… - ì¦ë¥˜ì†Œ - ë¸Œëžœë“œ - ì»¬ë ‰ì…˜ - ëª¨ë¸ - ë¦¬ë¦¬ì¦ˆ)

// ---- ê¸°ì—… ----
Table companies {
  id bigint [pk, increment]
  parent_company_id bigint [ref: > companies.id]
  company_logo varchar(255)
  company_name varchar(100) [not null, unique]
  translations text [note: "ë‹¤êµ­ì–´ ì§€ì› ì´ë¦„"]
  descriptions text [note: "ë‹¤êµ­ì–´ ì§€ì›"]
  independent_bottler boolean [not null, default: false]
  status DataStatus [not null, default: 'PENDING']
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_by bigint [ref: > users.id, not null]
  reviewed_at timestamp
  reviewed_by bigint [ref: > users.id]
}
Table company_revisions {
  id bigint [pk, increment]
  company_id bigint [ref: > companies.id, not null]
  schema_version varchar(16) [not null, default: '1.0']
  revision_data jsonb [not null]
  diff_data jsonb
  status DataStatus [not null, default: 'PENDING']
  is_latest boolean [not null, default: true, note: "ìƒì„± ì‹œ ì´ì „ ë²„ì „ ê°’ falseë¡œ ë³€ê²½"]

  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  reviewed_at timestamp
  reviewed_by bigint [ref: > users.id]

  // indexes {
  //   (company_id)
  //   (company_id) [unique, where: "is_latest = true"]
  // }
}

// ---- ì¦ë¥˜ì†Œ ----
Table distilleries {
  id bigint [pk, increment]
  company_id bigint [ref: > companies.id]
  distillery_logo varchar(255)
  distillery_name varchar(100) [not null, unique]
  translations text [note: "ë‹¤êµ­ì–´ ì§€ì› ì´ë¦„"]
  country_id bigint [ref: > countries.id]
  city_id bigint [ref: > cities.id]
  address varchar(255)
  established_in date
  descriptions text [note: "ë‹¤êµ­ì–´ ì§€ì›"]
  operational_status DistilleryOperationalStatus [not null, default: 'UNKNOWN']
  status DataStatus [not null, default: 'PENDING']
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_by bigint [ref: > users.id, not null]
  reviewed_at timestamp
  reviewed_by bigint [ref: > users.id]
}
Table distillery_revisions {
  id bigint [pk, increment]
  distillery_id bigint [ref: > distilleries.id, not null]
  schema_version varchar(16) [not null, default: '1.0']
  revision_data jsonb [not null]
  diff_data jsonb
  status DataStatus [not null, default: 'PENDING']
  is_latest boolean [not null, default: true, note: "ìƒì„± ì‹œ ì´ì „ ë²„ì „ ê°’ falseë¡œ ë³€ê²½"]

  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  reviewed_at timestamp
  reviewed_by bigint [ref: > users.id]

  // indexes {
  //   (distillery_id)
  //   (distillery_id) [unique, where: "is_latest = true"]
  // }
}
// ---- ë¸Œëžœë“œ-ì¦ë¥˜ì†Œ ê´€ê³„ ----
Table brand_distillery_relations {
  id bigint [pk, increment]
  brand_id bigint [ref: > brands.id, not null]
  distillery_id bigint [ref: > distilleries.id, not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
}
// ---- ë¸Œëžœë“œ ----
Table brands {
  id bigint [pk, increment]
  company_id bigint [ref: > companies.id]
  brand_logo varchar(255)
  brand_name varchar(100) [not null, unique]
  translations text [note: "ë‹¤êµ­ì–´ ì§€ì› ì´ë¦„"]
  descriptions text [note: "ë‹¤êµ­ì–´ ì§€ì›"]
  status DataStatus [not null, default: 'PENDING']
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_by bigint [ref: > users.id, not null]
  reviewed_at timestamp
  reviewed_by bigint [ref: > users.id]
}
Table brand_revisions {
  id bigint [pk, increment]
  brand_id bigint [ref: > brands.id, not null]
  schema_version varchar(16) [not null, default: '1.0']
  revision_data jsonb [not null]
  diff_data jsonb
  status DataStatus [not null, default: 'PENDING']
  is_latest boolean [not null, default: true, note: "ìƒì„± ì‹œ ì´ì „ ë²„ì „ ê°’ falseë¡œ ë³€ê²½"]

  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  reviewed_at timestamp
  reviewed_by bigint [ref: > users.id]

  // indexes {
  //   (brand_id)
  //   (brand_id) [unique, where: "is_latest = true"]
  // }
}
// ---- ì»¬ë ‰ì…˜(ì‹œë¦¬ì¦ˆ) ----
Table collections {
  id bigint [pk, increment]
  brand_id bigint [ref: > brands.id, not null]
  collection_name varchar(100) [not null]
  translations text [note: "ë‹¤êµ­ì–´ ì§€ì› ì´ë¦„"]
  descriptions text [note: "ë‹¤êµ­ì–´ ì§€ì›"]
  status DataStatus [not null, default: 'PENDING']
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_by bigint [ref: > users.id, not null]
  reviewed_at timestamp
  reviewed_by bigint [ref: > users.id]
}
Table collection_revisions {
  id bigint [pk, increment]
  collection_id bigint [ref: > collections.id, not null]
  schema_version varchar(16) [not null, default: '1.0']
  revision_data jsonb [not null]
  diff_data jsonb
  status DataStatus [not null, default: 'PENDING']
  is_latest boolean [not null, default: true, note: "ìƒì„± ì‹œ ì´ì „ ë²„ì „ ê°’ falseë¡œ ë³€ê²½"]

  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  reviewed_at timestamp
  reviewed_by bigint [ref: > users.id]

  // indexes {
  //   (collection_id)
  //   (collection_id) [unique, where: "is_latest = true"]
  // }
}

// ---- ëª¨ë¸ (ê°œë³„ ìƒí’ˆêµ°) ----
Table models {
  id bigint [pk, increment]
  collection_id bigint [ref: > collections.id, not null]
  category_id bigint [ref: > categories.id, note: "ì˜ˆ: ë²„ë²ˆ, ë¸”ëžœë””ë“œ ë“±"]
  model_image varchar(255)
  model_name varchar(100) [not null]
  translations text [note: "ë‹¤êµ­ì–´ ì§€ì› ì´ë¦„"]
  descriptions text [note: "ë‹¤êµ­ì–´ ì§€ì›"]
  status DataStatus [not null, default: 'PENDING']
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_by bigint [ref: > users.id, not null]
  reviewed_at timestamp
  reviewed_by bigint [ref: > users.id]
}
Table model_revisions {
  id bigint [pk, increment]
  model_id bigint [ref: > models.id, not null]
  schema_version varchar(16) [not null, default: '1.0']
  revision_data jsonb [not null]
  diff_data jsonb
  status DataStatus [not null, default: 'PENDING']
  is_latest boolean [not null, default: true, note: "ìƒì„± ì‹œ ì´ì „ ë²„ì „ ê°’ falseë¡œ ë³€ê²½"]

  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  reviewed_at timestamp
  reviewed_by bigint [ref: > users.id]

  // indexes {
  //   (model_id)
  //   (model_id) [unique, where: "is_latest = true"]
  // }
}
// ---- ë¦´ë¦¬ì¦ˆ-ì¦ë¥˜ì†Œ ê´€ê³„ ----
Table release_distillery_relations {
  id bigint [pk, increment]
  release_id bigint [ref: > releases.id, not null]
  distillery_id bigint [ref: > distilleries.id, not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
}
// ---- ë¦´ë¦¬ì¦ˆ (ì¶œì‹œ ìƒí’ˆ) ----
Table releases {
  id bigint [pk, increment]
  model_id bigint [ref: > models.id, not null]
  release_image varchar(255)
  release_name varchar(100) [not null]
  translations text [note: "ë‹¤êµ­ì–´ ì§€ì› ì´ë¦„"]
  age_statement_type AgeStatementType [not null, default: 'STATED']
  stated_age smallint [note: "age_typeì´ 'STATED'ì¼ ë•Œë§Œ ê°’ì´ ìžˆìŒ"]
  distilled_on date
  bottled_on date
  bottling_strength_type BottlingStrengthType [default: 'UNKNOWN']
  abv decimal(5,2) [not null]
  limited_edition TernaryStatus [not null, default: 'UNKNOWN', note: "í•œì •íŒ"]
  released_bottles varchar(32) [note: "ì´ ë°œë§¤ë³‘ìˆ˜(ì˜ˆ: '2000', '100/500' ë“±)"]
  single_cask TernaryStatus [not null, default: 'UNKNOWN']
  chill_filtered TernaryStatus [not null, default: 'UNKNOWN']
  natural_color TernaryStatus [not null, default: 'UNKNOWN']
  peat_level PeatLevel
  descriptions text [note: "ë‹¤êµ­ì–´ ì§€ì›"]
  status DataStatus [not null, default: 'PENDING']
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_by bigint [ref: > users.id, not null]
  reviewed_at timestamp
  reviewed_by bigint [ref: > users.id]
}
Table release_revisions {
  id bigint [pk, increment]
  release_id bigint [ref: > releases.id, not null]
  schema_version varchar(16) [not null, default: '1.0']
  revision_data jsonb [not null]
  diff_data jsonb
  status DataStatus [not null, default: 'PENDING']
  is_latest boolean [not null, default: true, note: "ìƒì„± ì‹œ ì´ì „ ë²„ì „ ê°’ falseë¡œ ë³€ê²½"]

  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  reviewed_at timestamp
  reviewed_by bigint [ref: > users.id]

  // indexes {
  //   (release_id)
  //   (release_id) [unique, where: "is_latest = true"]
  // }
}

// ================== ìºìŠ¤í¬(CASKS) ==================
// ---- ìºìŠ¤í¬ ìž¬ì§ˆ ----
Table cask_materials {
  id bigint [pk, increment]
  name varchar(50) [not null, unique, note: "ì˜ˆ: American Oak, European Oak, Mizunara ë“±"]
  translations text [note: "ë‹¤êµ­ì–´ ì§€ì›"]
  descriptions text [note: "ë‹¤êµ­ì–´ ì§€ì›"]
  status DataStatus [not null, default: 'PENDING']
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_by bigint [ref: > users.id, not null]
  reviewed_at timestamp
  reviewed_by bigint [ref: > users.id]
}
// ---- ìºìŠ¤í¬ ì¢…ë¥˜ ----
Table cask_types {
  id bigint [pk, increment]
  name varchar(50) [not null, unique, note: "ì˜ˆ: Barrel, Butt, Puncheon ë“±"]
  translations text [note: "ë‹¤êµ­ì–´ ì§€ì›"]
  size_litre INT [note: "ì˜ˆ: 200L, 500L ë“±"]
  descriptions text [note: "ë‹¤êµ­ì–´ ì§€ì›"]
  status DataStatus [not null, default: 'PENDING']
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  updated_by bigint [ref: > users.id, not null]
  reviewed_at timestamp
  reviewed_by bigint [ref: > users.id]
}
// ---- ìºìŠ¤í¬ ë§ˆìŠ¤í„° ----
Table casks {
  id bigint [pk, increment]
  name varchar(100) [not null, unique, note: "ì˜ˆ: PX Sherry Butt, Bourbon Barrel ë“±"]
  translations text [note: "ë‹¤êµ­ì–´ ì§€ì›"]
  fill_number FillNumber
  category_id bigint [ref: > categories.id, note: "ì˜ˆ: ë²„ë²ˆ, ì…°ë¦¬ì™€ì¸ ë“±"]
  material_id bigint [ref: > cask_materials.id]
  shape_id bigint [ref: > cask_types.id]
  descriptions text [note: "ë‹¤êµ­ì–´ ì§€ì›"]
  created_at timestamp [not null]
  created_by bigint [ref: > users.id, not null]
  updated_at timestamp [not null]
  updated_by bigint [ref: > users.id, not null]
  reviewed_at timestamp
  reviewed_by bigint [ref: > users.id]
}
// ---- ë¦´ë¦¬ì¦ˆë³„ ìºìŠ¤í¬ êµ¬ì„± ----
Table release_casks {
  id bigint [pk, increment]
  release_id bigint [ref: > releases.id, not null]
  cask_id bigint [ref: > casks.id, not null]
  proportion decimal(5,2) [note: "ë¹„ìœ¨(%)"]
  maturation_months smallint
  created_at timestamp [not null]
  created_by bigint [ref: > users.id, not null]
}

// ================== í‚¤ì›Œë“œ ==================
// (ë¸Œëžœë“œ, ì¦ë¥˜ì†Œ ë“± ì—”í„°í‹°ë³„ í‚¤ì›Œë“œ ë‹¤êµ­ì–´ ì €ìž¥)
Table company_tags {
  id bigint [pk, increment]
  company_id bigint [ref: > companies.id, not null]
  language_code LanguageCode [not null]
  tag varchar(50) [not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
}
Table distillery_tags {
  id bigint [pk, increment]
  distillery_id bigint [ref: > distilleries.id, not null]
  language_code LanguageCode [not null]
  tag varchar(50) [not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
}
Table brand_tags {
  id bigint [pk, increment]
  brand_id bigint [ref: > brands.id, not null]
  language_code LanguageCode [not null]
  tag varchar(50) [not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
}
Table collection_tags {
  id bigint [pk, increment]
  collection_id bigint [ref: > collections.id, not null]
  language_code LanguageCode [not null]
  tag varchar(50) [not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
}
Table model_tags {
  id bigint [pk, increment]
  model_id bigint [ref: > models.id, not null]
  language_code LanguageCode [not null]
  tag varchar(50) [not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
}
Table release_tags {
  id bigint [pk, increment]
  release_id bigint [ref: > releases.id, not null]
  language_code LanguageCode [not null]
  tag varchar(50) [not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
}

// ================== ëŒ“ê¸€ & íˆ¬í‘œ ==================
// ---- ë¸Œëžœë“œ ëŒ“ê¸€ (íˆ¬í‘œ)----
Table brand_comments {
  id bigint [pk, increment]
  brand_id bigint [ref: > brands.id, not null]
  parent_id bigint [ref: > brand_comments.id, note: "parent_idë¥¼ ê°–ê³  ìžˆëŠ” ê²½ìš° ì•ˆë¨"]
  language_code LanguageCode [not null]
  depth smallint [not null, note: "ì¹´í…Œê³ ë¦¬ ê¹Šì´ (ìµœëŒ€ 1), 0=ë£¨íŠ¸, 1=1ë‹¨ê³„"]
  comment text [not null]
  is_updated boolean [default: false, not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  deleted_at timestamp
}
Table brand_comment_votes {
  id bigint [pk, increment]
  brand_comment_id bigint [ref: > brand_comments.id, not null]
  vote_type VoteType [not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  indexes {
    (brand_comment_id, created_by) [unique]
  }
}

// ---- ì»¬ë ‰ì…˜ ëŒ“ê¸€ (íˆ¬í‘œ)----
Table collection_comments {
  id bigint [pk, increment]
  collection_id bigint [ref: > collections.id, not null]
  parent_id bigint [ref: > collection_comments.id]
  language_code LanguageCode [not null]
  depth smallint [not null, note: "ì¹´í…Œê³ ë¦¬ ê¹Šì´ (ìµœëŒ€ 1), 0=ë£¨íŠ¸, 1=1ë‹¨ê³„"]
  comment text [not null]
  is_updated boolean [default: false, not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  deleted_at timestamp
}
Table collection_comment_votes {
  id bigint [pk, increment]
  collection_comment_id bigint [ref: > collection_comments.id, not null]
  vote_type VoteType [not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  indexes {
    (collection_comment_id, created_by) [unique]
  }
}

// ---- ëª¨ë¸ ëŒ“ê¸€ (íˆ¬í‘œ)----
Table model_comments {
  id bigint [pk, increment]
  model_id bigint [ref: > models.id, not null]
  parent_id bigint [ref: > model_comments.id]
  language_code LanguageCode [not null]
  depth smallint [not null, note: "ì¹´í…Œê³ ë¦¬ ê¹Šì´ (ìµœëŒ€ 1), 0=ë£¨íŠ¸, 1=1ë‹¨ê³„"]
  comment text [not null]
  is_updated boolean [default: false, not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  updated_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  deleted_at timestamp
}
Table model_comment_votes {
  id bigint [pk, increment]
  model_comment_id bigint [ref: > model_comments.id, not null]
  vote_type VoteType [not null]
  created_at timestamp [not null, default: `CURRENT_TIMESTAMP`]
  created_by bigint [ref: > users.id, not null]
  indexes {
    (model_comment_id, created_by) [unique]
  }
}


